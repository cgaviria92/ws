<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Juego en tiempo real</title>
    <style>
        #game-container {
            width: 400px;
            height: 400px;
            border: 2px solid black;
            position: relative;
        }
        #player {
            width: 20px;
            height: 20px;
            background-color: red;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>
<body>

<h1>Juego WebSocket</h1>
<div id="game-container">
    <div id="player"></div>
</div>

<script>
    let socket = new WebSocket("ws://" + window.location.host + "/ws/game/");
    let player = document.getElementById("player");
    let x = 0, y = 0;

    socket.onopen = function () {
        console.log("Conectado al WebSocket.");
    };

    socket.onmessage = function (e) {
        let data = JSON.parse(e.data);
        if (data.action === "update_position") {
            x = data.x;
            y = data.y;
            player.style.left = x + "px";
            player.style.top = y + "px";
        }
    };

    document.addEventListener("keydown", function (event) {
        switch (event.key) {
            case "ArrowUp": y = Math.max(y - 10, 0); break;
            case "ArrowDown": y = Math.min(y + 10, 380); break;
            case "ArrowLeft": x = Math.max(x - 10, 0); break;
            case "ArrowRight": x = Math.min(x + 10, 380); break;
        }

        socket.send(JSON.stringify({
            action: "move",
            x: x,
            y: y
        }));
    });
</script>

</body>
</html>
